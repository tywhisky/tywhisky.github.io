<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>[Note] Design Patterns in Elixir - Happy Coding</title><link rel=icon type=image/png href=favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
This is a review note for José Valim's speech on YouTube


What's Design Pattern



A famous pic from Functional Programming Patterns (NDC London 2013)



But this might cause some misunderstandings about design patterns. An OOP programmer might think: 'Look, how clearly design patterns are defined!' Meanwhile, an FP programmer might think: 'Oh, functional programming is much better than OOP programming. There are no design patterns, everything is just functions!'"><meta property="og:image" content="//tywhisky.github.io/"><meta property="og:url" content="//tywhisky.github.io/posts/design-pattern-in-elixir/"><meta property="og:site_name" content="Happy Coding"><meta property="og:title" content="[Note] Design Patterns in Elixir"><meta property="og:description" content="This is a review note for José Valim's speech on YouTube
What's Design Pattern A famous pic from Functional Programming Patterns (NDC London 2013)
But this might cause some misunderstandings about design patterns. An OOP programmer might think: 'Look, how clearly design patterns are defined!' Meanwhile, an FP programmer might think: 'Oh, functional programming is much better than OOP programming. There are no design patterns, everything is just functions!'"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-25T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-25T00:00:00+00:00"><meta property="article:tag" content="Elixir DesignPattern"><meta name=twitter:card content="summary"><meta name=twitter:title content="[Note] Design Patterns in Elixir"><meta name=twitter:description content="This is a review note for José Valim's speech on YouTube
What's Design Pattern A famous pic from Functional Programming Patterns (NDC London 2013)
But this might cause some misunderstandings about design patterns. An OOP programmer might think: 'Look, how clearly design patterns are defined!' Meanwhile, an FP programmer might think: 'Oh, functional programming is much better than OOP programming. There are no design patterns, everything is just functions!'"><link href=//tywhisky.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=//tywhisky.github.io/css/main.a87126a5d38398207e58225b2d1a9faf97f546982f44b3ffb9715a264da36c90.css><link id=darkModeStyle rel=stylesheet type=text/css href=//tywhisky.github.io/css/dark.f163b79c6de51d14a766ff9f0563053de7f06a4d1bf7b85a59608bf96e566710.css media="(prefers-color-scheme: dark)"><script type=text/javascript src=//tywhisky.github.io/js/MathJax.js></script><script type=text/x-mathjax-config>
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script><link rel=stylesheet href=//tywhisky.github.io/katex/katex.min.css><script defer src=//tywhisky.github.io/katex/katex.min.js></script><script defer src=//tywhisky.github.io/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=content><header><div class=main><a href=//tywhisky.github.io/>Happy Coding</a></div><nav><a href=//tywhisky.github.io/>Home</a>
<a href=//tywhisky.github.io/posts>All posts</a>
<a href=//tywhisky.github.io/about>About</a>
<a href=//tywhisky.github.io/tags>Tags</a></nav></header><main><article><div class=post-container><div class=post-content><div class=title><h1 class=title>[Note] Design Patterns in Elixir</h1><div class=meta>Posted on May 25, 2024</div></div><section class=body><p>This is a review note for José Valim's speech on <a href="https://www.youtube.com/watch?v=agkXUp0hCW8">YouTube</a></p><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>What's Design Pattern</h2><div id=outline-text-headline-1 class=outline-text-2><p>A famous pic from <a href=https://www.slideshare.net/slideshow/fp-patterns-ndc-london2013/42373281>Functional Programming Patterns (NDC London 2013)</a></p><p><img src=//tywhisky.github.io/pattern-design-between-oop-and-fp.png alt=/pattern-design-between-oop-and-fp.png title=/pattern-design-between-oop-and-fp.png></p><p>But this might cause some misunderstandings about design patterns. An OOP programmer might think: 'Look, how clearly design patterns are defined!' Meanwhile, an FP programmer might think: 'Oh, functional programming is much better than OOP programming. There are no design patterns, everything is just functions!'</p><p>Obviously, all of these assumptions are incorrect. Borrowing the definition from 'A Pattern Language: Towns, Buildings, Construction' by Christopher Alexander, Sara Ishikawa, and Murray Silverstein with Max Jacobson, Ingrid Fiksdahl-King, and Shlomo Angel:</p><p>– Each pattern describes a problem which occurs over and over again in our environment, and then describes the core of the solution to that problem, in such a way that you can use this solution a million times over, without ever doing it the same way twice.</p><p>Design patterns are not about the solutions; they are about recurring problems. Therefore, design patterns are not exclusive to OOP. Functional programming languages do not need to translate design patterns from OOP; they have their own design patterns.</p></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>Design Pattern Overview</h2><div id=outline-text-headline-2 class=outline-text-2><p>Generally there are 23 design patterns, here we just talk about some of them which most specially.</p><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>01 Mediator</h3><div id=outline-text-headline-3 class=outline-text-3><div id=outline-container-headline-4 class=outline-4><h4 id=headline-4>Problem</h4><div id=outline-text-headline-4 class=outline-text-4><p>Imagine a GUI application with inputs, buttons, radio buttons, and dropdowns. The problem arises when changing any of these elements, such as selecting an option, requires updating other related elements. This can become very complex and require a massive amount of work. It's a very common scenario in modern development.</p><p>The Mediator Design Pattern provides an intuitive solution. Each component doesn't need to worry about how the others work. Instead, they all communicate with the mediator, which then decides how to coordinate their interactions.</p></div></div><div id=outline-container-headline-5 class=outline-4><h4 id=headline-5>Examples in Elixir</h4><div id=outline-text-headline-5 class=outline-text-4><ul><li>Phoenix Controllers, Phoenix LiveView</li></ul></div></div><div id=outline-container-headline-6 class=outline-4><h4 id=headline-6>Solutions in Elixir</h4><div id=outline-text-headline-6 class=outline-text-4><ul><li>Functions(and modules) for controlling and coordinating logic</li><li>Processes for controlling and coordinating events</li></ul></div></div></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>02 Facade</h3><div id=outline-text-headline-7 class=outline-text-3><div id=outline-container-headline-8 class=outline-4><h4 id=headline-8>Problem</h4><div id=outline-text-headline-8 class=outline-text-4><p><img src=//tywhisky.github.io/facade.png alt=/facade.png title=/facade.png></p><p>Imagine you have many subsystems, each containing numerous modules and components that need to communicate with each other. This can become very complex and overwhelming.</p><p>The Facade Design Pattern acts as an intermediary between these internal subsystems and the external systems. All interactions are routed through the facade, which provides simple, clean APIs for external use.</p></div></div><div id=outline-container-headline-9 class=outline-4><h4 id=headline-9>Examples in Elixir</h4><div id=outline-text-headline-9 class=outline-text-4><ul><li>Phoenix Contexts, Logger, the Elixir compiler</li></ul></div></div><div id=outline-container-headline-10 class=outline-4><h4 id=headline-10>Solutions in Elixir</h4><div id=outline-text-headline-10 class=outline-text-4><ul><li>Modules providing a simplified API to the more general facilities of a subsystem</li></ul></div></div></div></div><div id=outline-container-headline-11 class=outline-3><h3 id=headline-11>03 Strategy</h3><div id=outline-text-headline-11 class=outline-text-3><div id=outline-container-headline-12 class=outline-4><h4 id=headline-12>Problem</h4><div id=outline-text-headline-12 class=outline-text-4><p><img src=//tywhisky.github.io/strategy.png alt=/strategy.png title=/strategy.png>
The Strategy Design Pattern solves the problem of selecting and implementing an algorithm at runtime. It allows a class to delegate the implementation of a specific behavior to different algorithmic strategies, making the code more flexible and easier to maintain.</p></div></div><div id=outline-container-headline-13 class=outline-4><h4 id=headline-13>Example in Elixir</h4></div><div id=outline-container-headline-14 class=outline-4><h4 id=headline-14>Solutions in Elixir</h4><div id=outline-text-headline-14 class=outline-text-4><ul><li>Pattern matching</li></ul><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>def</span> compose(text, dimensions, strategy) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>case</span> strategy <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>:simple</span> <span style=color:#f92672>-&gt;</span> simple_compose(...)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>:tex</span> <span style=color:#f92672>-&gt;</span> tex_compost(...)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>:array</span> <span style=color:#f92672>-&gt;</span> array_compose(...)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>compose(text, dimensions, <span style=color:#e6db74>:simple</span>)
</span></span><span style=display:flex><span>compose(text, dimensions, <span style=color:#e6db74>:tex</span>)</span></span></code></pre></div></div><ul><li>Anonymous functions</li></ul><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>def</span> compost(text, dimensions, strategy) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  strategy<span style=color:#f92672>.</span>(...)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> simple_compose(text, dimensions) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  compose(text, dimensions, <span style=color:#66d9ef>fn</span> ... <span style=color:#66d9ef>end</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> tex_compose(text, dimensions) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  compose(text, dimensions, <span style=color:#66d9ef>fn</span> ... <span style=color:#66d9ef>end</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span></span></span></code></pre></div></div><ul><li>Behaviours</li></ul><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#a6e22e>@callback</span> compose(text, dimensions)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> compost(text, dimensions, strategy) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  strategy<span style=color:#f92672>.</span>compose()
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>compose(text, dimensions, <span style=color:#a6e22e>SimpleComposer</span>)
</span></span><span style=display:flex><span>compose(text, dimensions, <span style=color:#a6e22e>TexComposer</span>)</span></span></code></pre></div></div><ul><li>Protocols</li></ul><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>defprotocol</span> <span style=color:#a6e22e>Composer</span> <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> compose(text, dimensions)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> compose(text, dimensions, strategy) <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Composer</span><span style=color:#f92672>.</span>compose(...)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>compose(text, dimensions, %<span style=color:#a6e22e>SimpleComposer</span>{})
</span></span><span style=display:flex><span>compose(text, dimensions, %<span style=color:#a6e22e>TexComposer</span>{})</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-15 class=outline-3><h3 id=headline-15>04 Observer</h3><div id=outline-text-headline-15 class=outline-text-3><div id=outline-container-headline-16 class=outline-4><h4 id=headline-16>Problem</h4><div id=outline-text-headline-16 class=outline-text-4><p>The Observer Design Pattern addresses the problem of maintaining consistency between related objects without creating tight coupling between them. It provides a way for an object (the subject) to notify a list of dependent objects (observers) about changes in its state, so they can update themselves accordingly.</p></div></div><div id=outline-container-headline-17 class=outline-4><h4 id=headline-17>Examples in Elixir</h4><div id=outline-text-headline-17 class=outline-text-4><ul><li>Phoenix PubSub, Registry, telemetry</li></ul></div></div><div id=outline-container-headline-18 class=outline-4><h4 id=headline-18>Solutions in Elixir</h4><div id=outline-text-headline-18 class=outline-text-4><ul><li>Often message-passing across processes</li><li>May be local or distributed</li></ul></div></div></div></div></div></div><div id=outline-container-headline-19 class=outline-2><h2 id=headline-19>Design Patterns We No Longer Need in Elixir</h2><div id=outline-text-headline-19 class=outline-text-2><p>We've introduced four design patterns in Elixir. In fact, many design patterns become unnecessary due to the features of Elixir and functional programming:</p><p><img src=//tywhisky.github.io/design-patterns.png alt=/design-patterns.png title=/design-patterns.png></p><p>There's some instance:</p><div id=outline-container-headline-20 class=outline-3><h3 id=headline-20>Flyweight</h3><div id=outline-text-headline-20 class=outline-text-3><p>The Flyweight Design Pattern addresses the problem of efficiently managing a large number of fine-grained objects in order to reduce memory usage and improve performance. It achieves this by sharing common parts of the object state among multiple objects, rather than creating separate instances for each object.</p><p>It's a common problem in OOP language like:</p><div class="src src-javascript"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>a</span>() { <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Character</span>(<span style=color:#e6db74>&#34;a&#34;</span>) }
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>b</span>() { <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Character</span>(<span style=color:#e6db74>&#34;b&#34;</span>) }
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>c</span>() { <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Character</span>(<span style=color:#e6db74>&#34;c&#34;</span>) }</span></span></code></pre></div></div><p>Because the `Character` is an object, every time you call it is's a new instance. It has his own state, own behavior, so that means each of them have their space in memorys.</p><p>And how we implement in Elixir with the same thing:</p><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>def</span> a, <span style=color:#e6db74>do</span>: %<span style=color:#a6e22e>Character</span>{ <span style=color:#e6db74>char</span>: <span style=color:#e6db74>?a</span> }
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> b, <span style=color:#e6db74>do</span>: %<span style=color:#a6e22e>Character</span>{ <span style=color:#e6db74>char</span>: <span style=color:#e6db74>?b</span> }
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> c, <span style=color:#e6db74>do</span>: %<span style=color:#a6e22e>Character</span>{ <span style=color:#e6db74>char</span>: <span style=color:#e6db74>?c</span> }</span></span></code></pre></div></div><p>Our character is just data here, there's no behavior attached to it, there's no mutability, so the compiler just make a instance of this struct, and any time you call the function, the compiler just point it to the same place in memory. Obviously, the problem which need be solved by Flyweight will not appear in Elixir.</p></div></div><div id=outline-container-headline-21 class=outline-3><h3 id=headline-21>Interpreter</h3><div id=outline-text-headline-21 class=outline-text-3><p>The Interpreter Design Pattern addresses the problem of designing and implementing a language interpreter for a specific language or notation. It provides a way to evaluate sentences in a language by representing its grammar with a class hierarchy and defining an interpretation method for each grammar rule.</p><div id=outline-container-headline-22 class=outline-4><h4 id=headline-22>Solution in Elixir</h4><div id=outline-text-headline-22 class=outline-text-4><div class="src src-elixir"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-elixir data-lang=elixir><span style=display:flex><span>{<span style=color:#e6db74>:sequence</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;raining&#34;</span>,
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>:repeat</span>, {<span style=color:#e6db74>:or</span>, <span style=color:#e6db74>&#34;dogs&#34;</span>, <span style=color:#e6db74>&#34;cats&#34;</span>}}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> interpreter({<span style=color:#e6db74>:sequence</span>, left, right}, context)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> interpreter({<span style=color:#e6db74>:repeat</span>, node}, context)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> interpreter({<span style=color:#e6db74>:or</span>, left, right}, context)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> interpreter(literal, context) <span style=color:#f92672>when</span> is_binary(literal)</span></span></code></pre></div></div></div></div></div></div></div></div><div id=outline-container-headline-23 class=outline-2><h2 id=headline-23>Conclusion</h2><div id=outline-text-headline-23 class=outline-text-2><ul><li>Design patterns are applicable to Elixir</li><li>Elixir decomposes objects into 3 dimensions</li><li>Behaviours, Protocols, and message passing are tools for decoupling(rule of least expressiveness)</li></ul></div></div></section><div class=post-tags></div></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="yourDisqusShortname",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer><div style=display:flex><a class=soc href=https://github.com/tywhisky rel=me title=GitHub><svg class="feather"><use href="//tywhisky.github.io/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github"/></svg></a><a class=border></a></div><div class=footer-info>2026 Tainef | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>